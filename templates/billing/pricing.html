<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planes y Precios - AgroTech Digital</title>
    <link rel="shortcut icon" href="../../images/agrotech solo blanco.png">
    <link rel="stylesheet" href="../../style.css">
    <link href="https://unpkg.com/@tabler/icons-webfont@latest/tabler-icons.min.css" rel="stylesheet" />
    <script src="../../js/config.js"></script>
    <style>
        .pricing-hero{text-align:center;padding:140px 0 40px;}
        .pricing-hero h1{font-size:clamp(32px,5vw,56px);font-weight:800;letter-spacing:-0.03em;margin-bottom:12px;}
        .pricing-hero p{font-size:17px;color:var(--gris-400);max-width:520px;margin:0 auto;}
        .toggle-container{display:flex;align-items:center;justify-content:center;gap:14px;margin:36px 0 48px;}
        .toggle-label{font-size:14px;font-weight:600;color:var(--gris-600);cursor:pointer;transition:var(--transition-smooth);}
        .toggle-label.active{color:var(--texto-claro);}
        .toggle-switch{position:relative;width:52px;height:28px;background:var(--gris-800);border-radius:980px;cursor:pointer;transition:var(--transition-smooth);border:1px solid rgba(255,255,255,0.08);}
        .toggle-switch::after{content:'';position:absolute;top:3px;left:3px;width:20px;height:20px;background:var(--verde-claro);border-radius:50%;transition:var(--transition-smooth);box-shadow:0 2px 8px rgba(52,199,89,0.3);}
        .toggle-switch.active{background:rgba(52,199,89,0.15);border-color:rgba(52,199,89,0.3);}
        .toggle-switch.active::after{transform:translateX(24px);}
        .save-badge{font-size:12px;font-weight:700;color:var(--verde-claro);background:rgba(52,199,89,0.1);padding:4px 12px;border-radius:980px;border:1px solid rgba(52,199,89,0.2);}
        .pricing-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:80px;}
        .pricing-card{background:var(--gris-950);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius-xl);padding:40px 32px;position:relative;transition:var(--transition-smooth);}
        .pricing-card:hover{border-color:rgba(255,255,255,0.12);transform:translateY(-4px);}
        .pricing-card.featured{border-color:rgba(52,199,89,0.3);background:linear-gradient(135deg,rgba(52,199,89,0.05),transparent);}
        .badge{position:absolute;top:-12px;left:50%;transform:translateX(-50%);background:var(--verde-claro);color:#000;font-size:11px;font-weight:800;padding:4px 18px;border-radius:980px;letter-spacing:0.05em;}
        .pricing-card h3{font-size:20px;font-weight:700;margin-bottom:16px;}
        .price{display:flex;align-items:baseline;gap:2px;margin-bottom:8px;}
        .currency{font-size:20px;font-weight:600;color:var(--gris-200);}
        .amount{font-size:48px;font-weight:800;letter-spacing:-0.03em;}
        .period{font-size:14px;color:var(--gris-400);margin-left:4px;}
        .price-savings{display:inline-block;font-size:12px;font-weight:600;color:var(--verde-claro);margin-bottom:20px;}
        .features-list{list-style:none;padding:0;margin:24px 0 28px;}
        .features-list li{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:14px;color:var(--gris-200);}
        .check{color:var(--verde-claro);font-weight:700;font-size:16px;}
        .cross{color:var(--gris-700);font-size:16px;}
        .limit-tag{font-size:11px;font-weight:600;background:rgba(255,255,255,0.04);padding:2px 8px;border-radius:6px;color:var(--gris-400);}
        .btn-plan{display:block;width:100%;padding:14px;background:rgba(52,199,89,0.1);color:var(--verde-claro);border:1px solid rgba(52,199,89,0.2);border-radius:980px;font-size:15px;font-weight:700;font-family:'Inter',sans-serif;cursor:pointer;transition:var(--transition-smooth);}
        .btn-plan:hover{background:var(--verde-claro);color:#000;box-shadow:0 8px 24px rgba(52,199,89,0.3);}
        .comparison-section{margin-bottom:80px;}
        .comparison-section h2{text-align:center;font-size:clamp(24px,3vw,36px);font-weight:800;margin-bottom:40px;}
        .comparison-table-wrapper{overflow-x:auto;-webkit-overflow-scrolling:touch;}
        .comparison-table{width:100%;border-collapse:collapse;min-width:700px;}
        .comparison-table th,.comparison-table td{padding:16px 20px;text-align:center;border-bottom:1px solid rgba(255,255,255,0.04);font-size:14px;}
        .comparison-table th{font-weight:700;background:var(--gris-950);position:sticky;top:0;}
        .comparison-table th:first-child,.comparison-table td:first-child{text-align:left;font-weight:500;color:var(--gris-300);}
        .comparison-table td .check-icon{color:var(--verde-claro);font-size:18px;}
        .comparison-table td .cross-icon{color:var(--gris-700);font-size:14px;}
        .comparison-table tr:hover td{background:rgba(255,255,255,0.02);}
        .faq-section{max-width:720px;margin:0 auto 80px;text-align:center;}
        .faq-section h2{font-size:clamp(24px,3vw,36px);font-weight:800;margin-bottom:40px;}
        .faq-item{background:var(--gris-950);border:1px solid rgba(255,255,255,0.06);border-radius:16px;margin-bottom:12px;text-align:left;overflow:hidden;}
        .faq-q{padding:20px 24px;font-weight:600;font-size:15px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:var(--transition-smooth);}
        .faq-q:hover{color:var(--verde-claro);}
        .faq-a{max-height:0;overflow:hidden;transition:max-height 0.3s ease;padding:0 24px;font-size:14px;color:var(--gris-400);line-height:1.7;}
        .faq-item.open .faq-a{max-height:200px;padding-bottom:20px;}
        .faq-item.open .faq-q .arrow{transform:rotate(180deg);}
        .arrow{transition:transform 0.3s ease;font-size:18px;color:var(--gris-600);}
        @media(max-width:860px){.pricing-grid{grid-template-columns:1fr;max-width:420px;margin-left:auto;margin-right:auto;}}
    </style>
    <!-- Global Mobile Responsive -->
    <link href="../../css/global-mobile-responsive.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <img src="../../images/agrotech solo blanco.png" alt="AgroTech Digital">
                    <span>AgroTech Digital</span>
                </div>
                <div class="nav-menu">
                    <a href="../../index.html#features">Características</a>
                    <a href="pricing.html" class="active">Planes</a>
                    <a href="../authentication/login.html" class="btn-primary-nav">Iniciar Sesión</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="pricing-hero">
            <h1>Planes que se adaptan a ti</h1>
            <p>Desde pequeños productores hasta grandes empresas agrícolas. Sin compromisos, cancela cuando quieras.</p>
        </div>

        <div class="toggle-container">
            <span class="toggle-label toggle-monthly active">Mensual</span>
            <div class="toggle-switch" id="billingToggle"></div>
            <span class="toggle-label toggle-yearly">Anual</span>
            <span class="save-badge">Ahorra 20%</span>
        </div>

        <div class="pricing-grid" id="pricingCards"></div>

        <!-- Comparison Table -->
        <section class="comparison-section">
            <h2>Comparación detallada</h2>
            <div class="comparison-table-wrapper">
                <table class="comparison-table">
                    <thead><tr><th>Característica</th><th>Explorador</th><th>Agricultor</th><th>Empresarial</th></tr></thead>
                    <tbody>
                        <tr><td>Hectáreas</td><td>50</td><td>300</td><td>1,000</td></tr>
                        <tr><td>Análisis satelitales/mes</td><td>10</td><td>100</td><td>500</td></tr>
                        <tr><td>Usuarios</td><td>1</td><td>3</td><td>10</td></tr>
                        <tr><td>Parcelas</td><td>3</td><td>10</td><td>50</td></tr>
                        <tr><td>Análisis NDVI</td><td><span class="check-icon">✓</span></td><td><span class="check-icon">✓</span></td><td><span class="check-icon">✓</span></td></tr>
                        <tr><td>Análisis avanzado</td><td><span class="cross-icon">✗</span></td><td><span class="cross-icon">✗</span></td><td><span class="check-icon">✓</span></td></tr>
                        <tr><td>Pronóstico climático</td><td><span class="cross-icon">✗</span></td><td><span class="check-icon">✓</span></td><td><span class="check-icon">✓</span></td></tr>
                        <tr><td>Acceso API</td><td><span class="cross-icon">✗</span></td><td><span class="cross-icon">✗</span></td><td><span class="check-icon">✓</span></td></tr>
                        <tr><td>Soporte</td><td>Comunidad</td><td>Email</td><td>Prioritario 24/7</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- FAQ -->
        <section class="faq-section">
            <h2>Preguntas frecuentes</h2>
            <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">¿Puedo cambiar de plan después? <span class="arrow">▼</span></div><div class="faq-a">Sí, puedes upgrade o downgrade en cualquier momento. Los cambios se aplican de forma inmediata y se prorratea el monto.</div></div>
            <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">¿Qué métodos de pago aceptan? <span class="arrow">▼</span></div><div class="faq-a">Aceptamos tarjetas de crédito, débito, PSE, Nequi, Daviplata y más a través de MercadoPago.</div></div>
            <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">¿Los análisis satelitales son en tiempo real? <span class="arrow">▼</span></div><div class="faq-a">Utilizamos imágenes de los satélites Sentinel-2 y Landsat con una frecuencia de 3-5 días, procesadas mediante análisis satelital avanzado.</div></div>
            <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">¿Puedo cancelar en cualquier momento? <span class="arrow">▼</span></div><div class="faq-a">Sí, puedes cancelar tu suscripción en cualquier momento sin penalizaciones. Tu acceso continuará hasta el final del periodo facturado.</div></div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <div class="logo">
                        <img src="../../images/agrotech solo blanco.png" alt="AgroTech Digital">
                        <span>AgroTech Digital</span>
                    </div>
                    <p>Agricultura de precisión con análisis satelital avanzado para maximizar tu producción.</p>
                </div>
                <div class="footer-col">
                    <h4>Producto</h4>
                    <a href="../../index.html#features">Características</a>
                    <a href="pricing.html">Planes</a>
                    <a href="../authentication/login.html">Iniciar Sesión</a>
                </div>
                <div class="footer-col">
                    <h4>Empresa</h4>
                    <a href="#">Sobre Nosotros</a>
                    <a href="#">Blog</a>
                    <a href="#">Contacto</a>
                </div>
                <div class="footer-col">
                    <h4>Contacto</h4>
                    <p>info@agrotechdigital.com</p>
                    <p>+57 300 123 4567</p>
                    <p>Bogotá, Colombia</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 AgroTech Digital. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        var API = window.AGROTECH_CONFIG.API_BASE;
        var toggle = document.getElementById('billingToggle');
        var monthlyLabel = document.querySelector('.toggle-monthly');
        var yearlyLabel = document.querySelector('.toggle-yearly');
        var grid = document.getElementById('pricingCards');
        var isYearly = false;
        var plans = [];

        // Planes estáticos como fallback cuando el API no responde
        var FALLBACK_PLANS = [
            {
                tier: 'free', name: 'Explorador', description: 'Plan gratuito',
                price_cop: '0.00', price_usd: '0.00', frequency: 1,
                limits: { users: 1, parcels: 3, hectares: 50, eosda_requests: 10 },
                features_included: ['basic_analytics'],
                features_excluded: ['advanced_analytics', 'api_access'],
                is_custom: false, trial_days: 14,
                yearly_discount: { yearly_price_cop: 0, savings_cop: 0, yearly_price_usd: 0, savings_usd: 0, discount_percent: 20 }
            },
            {
                tier: 'basic', name: 'Agricultor', description: 'Plan profesional',
                price_cop: '79000.00', price_usd: '20.00', frequency: 1,
                limits: { users: 3, parcels: 10, hectares: 300, eosda_requests: 100 },
                features_included: ['basic_analytics', 'weather_forecast'],
                features_excluded: ['api_access'],
                is_custom: false, trial_days: 14,
                yearly_discount: { yearly_price_cop: 790000, savings_cop: 158000, yearly_price_usd: 200, savings_usd: 40, discount_percent: 20 }
            },
            {
                tier: 'pro', name: 'Empresarial', description: 'Plan empresarial',
                price_cop: '179000.00', price_usd: '45.00', frequency: 1,
                limits: { users: 10, parcels: 50, hectares: 1000, eosda_requests: 500 },
                features_included: ['basic_analytics', 'advanced_analytics', 'weather_forecast', 'api_access'],
                features_excluded: [],
                is_custom: false, trial_days: 14,
                yearly_discount: { yearly_price_cop: 1790000, savings_cop: 358000, yearly_price_usd: 450, savings_usd: 90, discount_percent: 20 }
            }
        ];

        toggle.addEventListener('click', function() { setBilling(!isYearly); });

        window.setBilling = function(yearly) {
            isYearly = yearly;
            toggle.classList.toggle('active', isYearly);
            monthlyLabel.classList.toggle('active', !isYearly);
            yearlyLabel.classList.toggle('active', isYearly);
            render();
        };

        function fetchPlans() {
            fetch(API + '/billing/api/plans/')
                .then(function(r) {
                    if (!r.ok) throw new Error('HTTP ' + r.status);
                    return r.json();
                })
                .then(function(data) {
                    if (data && data.length > 0) {
                        plans = data;
                    } else {
                        plans = FALLBACK_PLANS;
                    }
                    render();
                })
                .catch(function() {
                    console.warn('API no disponible, usando planes estáticos');
                    plans = FALLBACK_PLANS;
                    render();
                });
        }

        function fmt(n) { return new Intl.NumberFormat('es-CO').format(n); }

        var featureMap = {
            'basic_analytics': 'Análisis básico (NDVI)',
            'advanced_analytics': 'Análisis avanzado',
            'weather_forecast': 'Pronóstico climático',
            'api_access': 'Acceso a API'
        };

        function render() {
            grid.innerHTML = plans.map(function(p) {
                var featured = p.tier === 'basic';
                var price = isYearly ? p.yearly_discount.yearly_price_cop : parseFloat(p.price_cop);
                var period = isYearly ? '/año' : '/mes';
                var savings = (isYearly && p.yearly_discount.savings_cop > 0)
                    ? '<span class="price-savings">Ahorras $' + fmt(p.yearly_discount.savings_cop) + '</span>' : '';

                var items = [
                    '<li><span class="check">✓</span> Hasta ' + p.limits.hectares + ' hectáreas <span class="limit-tag">' + p.limits.hectares + ' ha</span></li>',
                    '<li><span class="check">✓</span> ' + p.limits.eosda_requests + ' análisis/mes <span class="limit-tag">' + p.limits.eosda_requests + '</span></li>',
                    '<li><span class="check">✓</span> ' + p.limits.users + ' usuario' + (p.limits.users > 1 ? 's' : '') + '</li>',
                    '<li><span class="check">✓</span> ' + p.limits.parcels + ' parcela' + (p.limits.parcels > 1 ? 's' : '') + '</li>'
                ];
                p.features_included.forEach(function(f) {
                    items.push('<li><span class="check">✓</span> ' + (featureMap[f] || f) + '</li>');
                });
                p.features_excluded.forEach(function(f) {
                    items.push('<li><span class="cross">✗</span> <span style="color:var(--gris-600)">' + (featureMap[f] || f) + '</span></li>');
                });

                var btn = (p.tier === 'free')
                    ? '<button class="btn-plan" onclick="selectPlan(\'' + p.tier + '\')">Probar Gratis</button>'
                    : '<button class="btn-plan" onclick="selectPlan(\'' + p.tier + '\')">Comenzar Ahora</button>';

                return '<div class="pricing-card ' + (featured ? 'featured' : '') + '">' +
                    (featured ? '<div class="badge">POPULAR</div>' : '') +
                    '<h3>' + p.name + '</h3>' +
                    '<div class="price">' +
                        (p.tier === 'free' ? '<span class="amount">Gratis</span>' :
                            '<span class="currency">$</span><span class="amount">' + fmt(price) + '</span><span class="period">' + period + '</span>') +
                    '</div>' + savings +
                    '<ul class="features-list">' + items.join('') + '</ul>' +
                    btn + '</div>';
            }).join('');
        }

        window.selectPlan = function(tier) {
            var cycle = isYearly ? 'yearly' : 'monthly';
            window.location.href = 'checkout.html?plan=' + tier + '&cycle=' + cycle;
        };

        fetchPlans();
    });
    </script>
</body>
</html>
